


<html><head>
<style type="text/css">
.part2{color:#4173a3;font-weight:900;}
.part2:hover{color:red;font-weight:880}
.cd{font-size:18px;color:black;}
.c2{font-size:18px;color:black;}
.c1{font-size:45pt;}
.cc{font-size:13pt;font-weight:bold}
.t{color:red;}
.a9{color:#4173a3;font-weight:bold;}
.a9:hover{color:red;font-weight:880}
h2{font-size:21pt;font-weight:bold}
h3{font-size:17pt;font-weight:bold}
.a19{color:#4173a3;font-size:18px}
.a19:hover{color:red;font-size:18px}
body{
BORDER-RIGHT: 0px;
SCROLLBAR-FACE-COLOR: #CFDEEB;
PADDING-BOTTOM: 0px;
SCROLLBAR-HIGHLIGHT-COLOR: #CFDEEB;
VERTICAL-ALIGN: middle;
BORDER-LEFT: 0px;
SCROLLBAR-SHADOW-COLOR: black;
SCROLLBAR-ARROW-COLOR: black;
PADDING-TOP: 0px;
BORDER-BOTTOM: 0px;
SCROLLBAR-BASE-COLOR: black;
scrollbar-3dlight-color: #4173a3;
scrollbar-dark-shadow-color: #4173a3;}
</style>

<title>Программируем на Visual Basic'e</title>
</head>
<body background="1.jpeg">
<em >
<a href="http://vbstreets.narod.ru" class="a9">Главная</a>
<a href="http://gb.lpt.ru/gb.php?bid=7132" class="a9">Гостевая</a>
<a href="http://gb.lpt.ru/gb.php?bid=7137" class="a9">Форум</a>
<a href="INFA.htm" class="a9">INFA</a>
</em>

<H1 ><font size=6>Программируем на Visual Basic'e:</font></H1>

<p style="font-weight:bold; font-size:21px" >


<a href="vbasic.htm" class="part2">Часть 1</a>/<a href="vbasic2.htm" class="part2">Часть 2</a>/<a href="vbasic3.htm" class="part2">Часть 3</a>/<a href="vbasic4.htm" class="part2">Часть 4</a>/<a href="vbasic5.htm" class="part2">Часть 5</a>/<a href="vbasic6.htm" class="part2">Часть 6</a>/Часть 7/<a href="vbasic8.htm" class="part2">Часть 8</a>/<a href="vbasic9.htm" class="part2">Часть 9</a>/<a href="vbasic10.htm" class="part2">
Часть 10</a>  /<a href="vbasic11.htm" class="part2">Часть 11</a>/<a href="vbasic12.htm" class="part2">Часть 12</a>/<a href="vbasic13.htm" class="part2">Часть 13</a>

/<a href="vbasic14.htm" class="part2">Часть 14</a>/<a href="vbasic15.htm" class="part2">Часть 15</a>

</font>
</p>

<h2>ШАГ 61:</h2>
<h3>Формы</h3><p class="c2">
Не помню, говорил я тебе как можно использовать не одну, а несколько форм. Ну в любом случае скажу. Как всегда сделаем новый проект(Standart EXE), добавим еще одну форму(Form2), для этого нажми Project/Add Form и в открывшимся окне кликни по Form. У тебя появится еще одна форма.
Но при включении проекта ее у тебя видно не будет, а это потому что она скрыта, а чтоб ее показать воспользуемся свойством Show. Вот код:<br>
Private Sub Form_Load()<FONT color=Green > 'При загрузке формы:</FONT><br> 
Form2.Show<FONT color=Green > 'Показываем форму2</FONT><br> 
End Sub<br>
Вот и все! А чтоб можно было из одной формы менять свойство другой - тебе надо прочитать следующий шаг.


 
<h2>ШАГ 62:</h2>
<h3>Связь между формами</h3><p class="c2">
Ну что - то мне это в бошку слишком поздно пришло, это надо было писать в 4 части, а я в 6. Очень часто надо из 1 формы поменять какое - нибудь свойство у второй. И как это сделать читай в этом шаге. Сейчас мы сделаем прогу, у которой из первой формы, мы будем менять свойство второй. Как всегда сделаем новый проект(Standart EXE), создай новую форму(Form2), на нее кинь кнопку, и на первую форму(Form1), тоже кинь кнопку. Код:<br>

Private Sub Form_Load()<FONT color=Green > 'При загрузке формы:</FONT><br> 
Form2.Show<FONT color=Green > 'Показываем Форму 2(Form2)</FONT><br> 
End Sub<br>
<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
Form2.Command1.Caption = ""<FONT color=Green > 'Меняем свойство Caption у кнопки второй формы</FONT><br> 
End Sub<br>
<br>
И все!
<h2>ШАГ 63:</h2>
<h3>Делаем тень для Label`a</h3><p class="c2">
Хей чуваки - кто хочет стать Хакером? Я уверен на 100% что все - и я уже начал готовить (пока только думать) темы, но вскоре появится и учебник. Его ты сможешь скачать с моего сайта(<a href="http://vbstreets.narod.ru" class=a19>vbstreets.narod.ru</A>), 
и скорее всего в следующих обновления моего учебника (по VB).Ну что - то я заболтался - ПЕРЕЙДЕМ К ДЕЛУ. Войди в VB(Standart EXE) - на форму кинь 2 метки, и 1 текстовое поле. Выдели 2 метки и поставь у них свойство BackStyle = 0 - Transparent, и свойство AutoSize = True. Первую метку сделай серой(ForeColor), но так чтоб она не сливалась с формой. Код:<br><br>

Private Sub Form_Load()<FONT color=Green > 'При загрузке формы:</FONT><br> 
Label1.Left = Label2.Left + 70<FONT color=Green > 'Метка 1(тень) была немного правее метки 2</FONT><br> 
Label1.Top = Label2.Top<FONT color=Green > 'Делаем их на одной высоте</FONT><br> 
Label1.ZOrder (1)<FONT color=Green > 'Делаем метку 1(тень) под меткой 2</FONT><br> 
End Sub<br><br>
Private Sub Text1_Change()<FONT color=Green > 'При изменении текста:</FONT><br> 
<FONT color=Green > 'Текст у всех меток тоже меняется</FONT><br> 
Label2.Caption = Text1.Text<br>
Label1.Caption = Text1.Text<br>
End Sub<br>
<br>
<h2>ШАГ 64:</h2>
<h3>Правильно работаем с Текстовым Полем</h3><p class="c2">
Не зная о чем написать, решил я в начале сделать какую - нибудь прогу, но потом передумал. И вот сижу я за компом, играю в GTA в Твери, и вдруг меня осенило, я даже чуть с кресла не упал, что ведь про ListBox, СкрулБар... были темы, а про текстовое поле еще нет. И в этом шаге я тебе о них и расскажу. В начале о свойствах: Здесь я не буду перечислять все свойства, т.к. половину ты точно знаешь, а скажу только самые не известные (хотя о них почти в каждой части по децелу написано):<br>
1. Multuline - Это самое известное свойство, оно нужно для переключения в однострочный и многострочный режим (мож это как - нибудь по другому называется, но т.к. я где - то услышал умное слово, то и решил им воспользоваться). Если стоит False - то однострочный режим, True - многострочный.<br>
2. MaxLenght - это ограничитель вводимых символов. Например, если ты там напишешь 2 - то сможешь ввести только 2 символа. Вот так.<br>
3. ScrollBars - это свойство нужно для установки скруллбаров (полос прокрутки).
<br><br>
А теперь события. При двойном клике по текстовому полю, создается процедура Text1_Change(). В какой - то части я говорил что это переводится как изменение. Так вот, при каждом изменении содержимого текстового поля, будет выполняться какое - то действия. И чтоб ты убедился что я не вру, сделаем прогу. На форму кинь текстовое поле и метку. При вводе текста в текстовое поле, надпись метки будет меняться. Код:
<br>
Private Sub Text1_Change()<br>
Label1.Caption = Text1.Text<br>
End Sub<br>
Все!
<h2>ШАГ 65:</h2>
<h3>Свойства</h3><p class="c2">
И снова свойства скажешь ты, и будешь прав. Но на этот раз будут еще и методы (это тоже самое что и свойства, только свойства описывают объект (цвет, размер, фон…), а методы выполняют какое - то действие над объектом (и в списке напротив них зеленый значок, а у свойств - серый)). Начнем. Первое свойство будет SetFocus, оно нужно для установки курсора в заданное текстовое поле. Сделаем прогу! На форму кинь 2 текстовых поля, и кнопку. Код:<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
Text1.SetFocus<FONT color=Green > 'На текстовое поле 1 устанавливаем курсор </FONT><br> 
End Sub<br>
Включай и смотри, при нажатии на кнопку курсор установится в текстовое поле 1.<br>
Теперь сделаем прогу, у которой текст будет выделяться. Ты не думай, что я тебе какую - то фигню в париваю - НЕТ! НЕТ! и еще раз НЕТ!.  Я тебя готовлю к созданию проги, которая будет искать текст вписанный в текстовое поле 1, из текстового поля 2. Ну как я и говорил будем делать прогу (выделение текста). На форму кинь 1 кнопку, и 1 текстовое поле. Теперь код:<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
Text1.Text = "Visual Basic"<FONT color=Green > 'Текст в текстовом поле будет равен "Visual Basic"</FONT><br> 
Text1.SetFocus<FONT color=Green > 'Курсор ставим в Text1</FONT><br> 
Text1.SelStart = 7<FONT color=Green > 'Эта функция задает позицию курсора в тексте (у нас в словах Visual Basic, позиция будет равна 7, т.е. курсор будет перед B)</FONT><br> 
Text1.SelLength = 5<FONT color=Green > 'Теперь выделяем 5 символов, т.е. Basic, т.к. начинаем выделять с того места, где стоит курсор, а курсор стоит перед B</FONT><br> 
End Sub<br>
На свойствах мы закончем, и перейдем к функциям.
<h2>ШАГ 66:</h2>
<h3>Функция InStr</h3><p class="c2">
Ну здесь я дам тебе функции, верней функцию, тоже для работы с текстом, и тоже она нам пригодится для создания "Поиска". Эта функция нужна для сравнивания 2-х слов. <br>Как всегда, сделаем прогу. Она будет сверять 2 текстовых поля, и в случае совпадения, выдавать соответствующее сообщение. Код:<br>
Private Sub Command2_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
If InStr(1, Text1.Text, Text2.Text) <> 0 Then<FONT color=Green > 'Сверяется 2 текстовых поля</FONT><br> 
MsgBox "Совпадение"<FONT color=Green > 'При совпадении юзер узнает об этом</FONT><br> 
Else<br>
MsgBox "Не Совпадение"<FONT color=Green > 'При не совпадении юзер все равно узнает об этом</FONT><br> 
End If<br>
End Sub<br>
Хей чел, испугался этого кода? Не бойся! Теперь я тебе объясню по лучше.
Как ты наверное догадался (или нет?), что функция InStr сверяет 2 слова (в нашем случае 2 текстовых поля), и в случае положительного результата (Совпадения), она будет равна 1, а в случае отрицательного 0. И вот мы здесь поставили условие, что если 2 текстовых поля совпадают (если они не равны 0(<>0)), то происходит одно действие, а если не совпадают то происходит другое (это делается с помощью Else(я тебе говорил о нем в первой части, но если ты не понял, то вместо него можешь написать if InStr(1, Text1.Text, Text2.Text) = 0)).Все! Делаем прогу!
<h2>ШАГ 67:</h2>
<h3>Делаем ПОИСК</h3><p class="c2">
Щас мы сделаем прогу, которая будет искать текст. На форму кинь 2 текстовых поля и кнопку. Вот код:<br>
Dim qw As Long<FONT color=Green > 'Объявляем переменную qw для работы с числами</FONT><br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br>

If InStr(qw, Text2.Text, Text1.Text) <> 0 Then<FONT color=Green > 'Сверяется 2 текстовых поля</FONT><br> 
Text2.SetFocus<FONT color=Green > 'На Text2 ставим курсор</FONT><br> 

Text2.SelStart = InStr(qw, Text2.Text, Text1.Text) - 1<FONT color=Green > 'Устанавливаем курсор перед совпавшимся словом</FONT><br> 
Text2.SelLength = Len(Text1.Text)<FONT color=Green > 'С помощью функции Len считаем сколько символов в Текстовом поле 1,и столько же выделяем</FONT><br> 

qw = InStr(qw, Text2.Text, Text1.Text) + Len(Text1.Text)<FONT color=Green > ' Изменяем переменную на позицию курсора</FONT><br> 

Else<FONT color=Green > ' Если в тексте больше нет искомого слова, то выводим об этом сообщение.</FONT><br> 
MsgBox "Здесь таких нет!!!"<br>
End If<br>
End Sub<br>
Private Sub Form_Load()<br>
qw = 1<br>
End Sub<br>
<br>
Исходник проги качай 
<a href="TextFind.zip" class="a19">отсюда</a>





<h2>ШАГ 68:</h2><h3>Отладка<br></h2><p class="c2">
Скорее всего каждая твоя прога содержит кучу ошибок, чаще всего это неправильные
действия юзера. Для того чтоб этого избежать в VB, и в других языках есть отладка.
Здесь я не буду говорить тебе о всех способах нахождения и устранения ошибок, т.к. сам в этом 
не силен, но расскажу о самом главном.<br>
1. <b>Игнорирование ошибок.</b>Для игнорирования ошибок служит оператор On Error Resume Next.<br>
Вот маленький пример из моей проги "Кодировщик". Подключите библиотеку Microsoft Common Dialog 6.0, назовите ее CD1
Private Sub Command1_Click()
 <font color="#006600" >  'При нажатии на кнопку:</font><br>
CD1.ShowOpen <font color="#006600" >  'Открывается окно открытия файлов</font><br>
d = FreeFile<br>
Open CD1.filename For Output As d 
<font color="#006600" >  'Открывается выбранный юзером файл (если юзер не выбрал файл (нажал отмена), то произойдет ошибка)</font><br>
Close d <font color="#006600" >  'Закрываем файл</font><br>
End Sub<br>
Не поленись скопируй этот текст в VB, и не забудь подключить библиотеку. А вот пример этой же проги, 
только уже отлаженной:<br>

Private Sub Command1_Click()<br>
CD1.ShowOpen<br>
d = FreeFile<br>
On Error Resume Next<font color="#006600" >  ' Если юзер не выбрал файл, то ошибка игнорируется</font><br>
Open CD1.filename For Output As d<br>
Close d<br>
End Sub<br>
2. <b>Способ перескока.</b>В этом способе при возникновении ошибки будет перескакивать на заданную позицию. Пример отлаженной проги:<br>

Private Sub Command1_Click()<br>
CD1.ShowOpen<br>
d = FreeFile<br>
On Error GoTo Ошибка<font color="#006600" >  'Если происходит ошибка то происходит перескакивание до Ошибке:</font><br>
Open CD1.filename For Output As d <br>
Close d <br>
MsgBox ""<font color="#006600" >  'Здесь я специально поставил MsgBox, чтобы ты почувствовал разницу</font><br>
Ошибка:<font color="#006600" >  'Досюда происходит перескок</font><br>
End Sub<br>
Напоминаю, что чтобы произошла ошибка, нажми на кнопку, и в окне открытия файлов, нажми на Отмена.

<br>
3. <b>Перехват Ошибок.</b> Описание этого способа ты не где ни найдешь кроме моего учебника (т.к. его я сам придумал), но мож найдешь похожее. Если тебя закалибала какая - то ошибка, то ты можешь ее игнорировать, или заменить.
Чтобы узнать номер ошибки, и то что в ней написано, есть объект Err.
Для начала нам надо узнать номер ошибки. Для этого создай новый проект(Standart EXE), на форму кинь Текстовое поле, и кнопку.<br>
CD1.ShowOpen<br>
d = FreeFile<br>
On Error GoTo Ошибка<font color="#006600" >  'Если происходит ошибка то происходит перескакивание до Ошибке:</font><br>
Open CD1.filename For Output As d <br>
Close d <br>
MsgBox ""<font color="#006600" >  'Здесь я специально поставил MsgBox, чтобы ты почувствовал разницу</font><br>
Ошибка:<font color="#006600" >  'Досюда происходит перескок</font><br>
Text1.Text = Err.Number<font color="#006600" >  'Если в Окне открытия файлов, юзер нажмет на Отмена, то произойдет Ошибка, и ее номер куда - то запишется, и мы с помощью объекта Err узнаем ее номер (в текстовом поле)</font><br>
End Sub<br>
Зная номер ошибки (а мы уже знаем!), можно ее заменить.<br>

Private Sub Command1_Click()<br>
CD1.ShowOpen <br>
d = FreeFile<br>
<br>
On Error GoTo g<font color="#006600" >  'Если происходит ошибка, то мы игнорируем ее</font><br>
Open CD1.filename For Output As d <br>
Close d<br>
g:<br>
If Err.Number = 75 Then<font color="#006600" >  'Зная номер ошибки мы можем что - нибудь сделать (например обосрать юзера...)</font><br>
MsgBox "Не нажимай на ОТМЕНУ - ЛАМЕР ПОГАНЫЙ!!!", 16<br>
End If<br>
End Sub<br><br>





На этом все, если в тебе кипит кровь, и ты хочешь узнать об отладке больше, то в поищи в Яндексе, там статей на эту тему до сраки.







<h2>ШАГ 69:</h2>
<h3>Процедуры и функции</h3><p class="c2">
Процедуры и функции - нужны для того, чтобы один и тот же код не писать несколько раз. Например, записав в функции код, его можно вызывать несколько раз. Ну ты скажешь: "Я не лентяй, напишу 2 раза - не здохну" - нет ты не прав, я раньше также думал, до тех пор пока 
не стал делать большие проги, в них очень часто приходится повторять код (и не 2 раза), и без функций не обойтись. Начнем с функций, т.к. по процедурам я не спец (и это сильно сказано):<br>
Для объявления функций тебе надо записать:<br><br>
Function Имя функции()<br>
Код<br>
End Function<br>
<br>
Ну думаю здесь все понятно, хотя влятри, в любом случае сделаем прогу. На форму кинь 2 кнопки.
<br>
<br>

Function Bla()<FONT color=Green > 'Объявляем функцию Bla</font><br> 
MsgBox "Фу бля, это моя первая функция"<FONT color=Green > 'Код</FONT><br> 
End Function<FONT color=Green > 'Завершаем функцию, это можно не писать, т.к. после написания первой строчки, это фенька создается автоматом</FONT><br> 
<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
Bla<FONT color=Green > 'Запускается функция Bla</FONT><br> 
End Sub<br>
<br>
Private Sub Command2_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br> 
Bla<FONT color=Green > 'Запускается функция Bla</FONT><br> 
End Sub<br><br>

Ну с процедурами такая же петрушка, т.к. в них я не спец, то, что я сейчас придумаю (на ходу), может быть не точно (скорее всего), и если вы найдете ошибку (или вранье), то мыльте, <a href="mailto:padre03@mail.ru" class=a19>padre03@mail.ru</a> и я исправлю. При двойном клике по кнопке создается процедура Click, ну вообще я подумал, и решил, что не буду тебе гнать о них, лучше сам о них почитаю.
<h2>ШАГ 70:</h2>
<h3>Модули - с чем их едят?</h3>
<p class="c2">
Модули нужны для объявления глобальных переменных, т.е. переменных которые могут использоваться во всем проекте (во всех формах...), и для объявления API функций. Чтобы создать модуль тебе надо войти в Project/Add Module и нажать Module. Все модуль создан! Отлично чел, ты создал свой первый модуль! Так держать! Но у тебя возникает вопрос: "Что я буду с ним делать?" - а что захочешь, но в начале тебе надо узнать о Public`e & Private`e. <br> 
Ну короче префикс Private нужен для объявления переменных и им подомных внутри модуля.
<br>
А Public нужен для объявления переменных во всем проекте, т.е. глобальных. Ну как ты наверное понял - все это подготовка к API
<br><br>

Фу блин, наконец дописал. Все! Теперь лофа кончилась! В следующей части тебе придется попотеть,
т.к. будут API 
функции. Это уже не детские игры. Если у тебя есть вопросы по этой части, то 
оставляй их на форуме, гостевой книге, или пиши в наглую на мыло: <a href="mailto:padre03@mail.ru" class=a19>padre03@mail.ru</a>
<br>
  И если ты зайдешь на мой сайт, кликни плиз по банеру Porta(сиреневый), мне за это немного бабла отвалется(2 цента). И если ты захочешь поддержать Отечественного производителя(т.е. Меня), то кликай по банеру раз в месяц. А если ты очень богатый, то не просто кликни, а еще что - нибудь купи.


<br><br>

<em><p class="cc">автор учебника: Падре</em>
<br>
Дата создания: 17 Марта 2003 года<br></em>
<br></p>

<center>
<table width=468 height=60 border=2 bordercolor="#4173a3"><td  bordercolor="#4173a3"><center>
<p class="c2">Место под Банеры
</td>
<tr><td>
<center>
<a href="INFA.htm" target="0">
<img src="baner.gif" alt="Официальный сайт учебника - 'Программируем на Visual Basic'" border=0>
</a></center>
</td></table>






</body>
</html>
