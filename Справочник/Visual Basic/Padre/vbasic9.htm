
<html><head>
<style type="text/css">
.part2{color:#4173a3;font-weight:900;}
.part2:hover{color:red;font-weight:880}
.cd{font-size:18px;color:black;}
.c2{font-size:18px;color:black;}
.c1{font-size:45pt;}
.cc{font-size:13pt;font-weight:bold}
.t{color:red;}
.a9{color:#4173a3;font-weight:bold;}
.a9:hover{color:red;font-weight:880}
h2{font-size:21pt;font-weight:bold}
h3{font-size:17pt;font-weight:bold}
.a19{color:#4173a3;font-size:18px}
.a19:hover{color:red;font-size:18px}
body{
BORDER-RIGHT: 0px;
SCROLLBAR-FACE-COLOR: #CFDEEB;
PADDING-BOTTOM: 0px;
SCROLLBAR-HIGHLIGHT-COLOR: #CFDEEB;
VERTICAL-ALIGN: middle;
BORDER-LEFT: 0px;
SCROLLBAR-SHADOW-COLOR: black;
SCROLLBAR-ARROW-COLOR: black;
PADDING-TOP: 0px;
BORDER-BOTTOM: 0px;
SCROLLBAR-BASE-COLOR: black;
scrollbar-3dlight-color: #4173a3;
scrollbar-dark-shadow-color: #4173a3;}
</style>

<title>Программируем на Visual Basic'e</title>
</head>
<body background="1.jpeg">
<em >
<a href="http://vbstreets.narod.ru" class="a9">Главная</a>
<a href="http://gb.lpt.ru/gb.php?bid=7132" class="a9">Гостевая</a>
<a href="http://gb.lpt.ru/gb.php?bid=7137" class="a9">Форум</a>
<a href="INFA.htm" class="a9">INFA</a>
</em>

<H1 ><font size=6>Программируем на Visual Basic'e:</font></H1>

<p style="font-weight:bold; font-size:21px" >

<a href="vbasic.htm" class="part2">Часть 1</a>/<a href="vbasic2.htm" class="part2">Часть 2</a>/<a href="vbasic3.htm" class="part2">Часть 3</a>/<a href="vbasic4.htm" class="part2">Часть 4</a>/<a href="vbasic5.htm" class="part2">Часть 5</a>/<a href="vbasic6.htm" class="part2">Часть 6</a>/<a href="vbasic7.htm" class="part2">Часть 7</a>/<a href="vbasic8.htm" class="part2">Часть 8</a>/Часть 9/<a href="vbasic10.htm" class="part2">
Часть 10</a>  /<a href="vbasic11.htm" class="part2">Часть 11</a>/<a href="vbasic12.htm" class="part2">Часть 12</a>/<a href="vbasic13.htm" class="part2">Часть 13</a>/<a href="vbasic14.htm" class="part2">Часть 14</a>/<a href="vbasic15.htm" class="part2">Часть 15</a></font>
</p>









<h2>ШАГ 81:</h2><h3>Компонент Microsoft Rich Textbox Control 6.0:</h3><p class="c2">
Этот компонент нужен для открытия больших файлов, ведь текстовое поле не потянет файл весом 50 - 60 KB, а разместив этот компонент, ты сможешь открывать большие файлы. установив галку на компоненте Microsoft Rich Textbox Control 6.0
у тебя на панели инструментов появится объект Rich TextBox. Но этот компонент нужен не тока для этого, с помощью него можно в одном текстовом поле поместить текст с разным цветом, шрифтом... Вот например щас сделаем прогу. На форму кинь 4 кнопки, 1 Rich TextBox.<br><br>
<img src="Rich.jpg"><br><br>





Private Sub Command1_Click()<br>
RichTextBox1.SelColor = vbRed <FONT color=Green > ' Делаем цвет текста красный</font><br>
End Sub<br>
<br>
Privte Sub Command2_Click()<br>
RichTextBox1.SelFontSize = 15 <FONT color=Green > ' Меняем размер шрифта</font><br>
End Sub<br>
<br>
Private Sub Command3_Click()<br>
RichTextBox1.SelItalic = 1    <FONT color=Green > ' Делаем шрифт курсивный</font><br> 
End Sub<br>
<br>
Private Sub Command4_Click()<br>
RichTextBox1.SelBold = 1     <FONT color=Green >  ' Делаем шрифт жирный</font><br> 
End Sub<br>
<br>

<img src="RichP.jpg"><br><br>

Ну что впечатляет? А в текстовом поле такого сделать нельзя.
Исходник - <a href="Rich.zip" class="a19">Здесь</a>










<h2>ШАГ 82:</h2><h3>PasswordChar:</h3><p class="c2">
Свойство PasswordChar нужно для скрытия в текстовых полях текста. Это как при соеденение с инетом, в соединение пароль скрыт звездочками. Так и это свойство, делает тоже самое.  На форму кинь Textовое поле. Код:<br><br>

Private Sub Form_Load()<br>
Text1.PasswordChar = "*"<FONT color=Green >'Скрываем звездочками текст в текстовом поле.</font><br>
End Sub<br><br>

Вот в этом примере показано как скрывать пароли от Злых и Добрых дядек. Но есть одно НО, все скрытые пароли можно рассекретить с помощью спец прог. Если мне не веришь, то скачай вот <a href="hack.zip" title="Пароли" class="a19"> вот эту</a> прогу(Хей! Она же на VB написана). Открой ее, и открой нашу прогу. Теперь нажми на текстовое поле - звездочек нет! И чтоб этого избежать, у Билл Гейца не хватило ума, сделать прогу(Даже я смог!). Эту прогу мы сделаем через Шаг.

<h2>ШАГ 83:</h2><h3>Ловим нажатые клавиши.</h3><p class="c2">
Для ловки нажатых клавишь сделаем прогу. На форму кинь кнопку(Caption = "", Enabled = False). Код:<br><br>

Private Sub Form_KeyPress(KeyAscii As Integer)<FONT color=Green > 'Событие KeyPress, если ты не забыл, действует тогда, когда нажата какая - нибудь клавиша</font><br>
Command1.Caption = Command1.Caption + Chr(KeyAscii)<FONT color=Green > 'Надпись кнопки = надписи кнопки + Chr(KeyAscii). KeyAscii - код нажатой клавиши, только он в Ascii кодировке. А с помощью функции Chr(про нее читай в 7 Шаге) мы переводим из Ascii в обычную кодировку. Если KeyAscii = 0 то сигнала от клавы нет.</font><br>
End Sub<br><br>

<h2>ШАГ 84:</h2><h3>Защита.</h3><p class="c2">
Принцип защиты будет прост - наеб...а(кто не понял, скажу по русски(хотя и там было по русски), я имел введу обман. Да, да, принцип защиты будет обман). Мы не будем пользоваться свойствами PasswordChar, а в Текстовое поле будем посылать свои звездочки. На форму кинь 2 текстовых поля(В Text1 будет все зассекречено звездочками, а в Text2 без них(и свойство Text у них = "")). Код:<br><br>





<FONT color=Green > '</font><br>



Private Sub Text1_KeyPress(KeyAscii As Integer)<FONT color=Green > 'Если в Text1(т.е. должен курсор в нем мегать) нажата клавиша клавы то:</font><br>
Text2.Text = Text2.Text + Chr(KeyAscii) 
<FONT color=Green > 'Text2.text = Text2.Text + Нажатая клавиша(с помощью KeyAscii ловим нажатую клавишу, а с функцией Chr переводим ее из Ascii в обычную кодировку)</font><br>

If KeyAscii = 8 Then 
<FONT color=Green > 'Если юзер нажимает на BackSpace то:</font><br>


KeyAscii = 8 
<FONT color=Green > ' Посылаем код нажатой клавиши BackSpace(т.е. стирается один символ из текстового поля)</font><br>

Else <FONT color=Green > ' Если юзер не нажал BackSpace, а нажал на другую клавишу то:</font><br>

Text1.Text = Text1.Text + "*" <FONT color=Green > 'К Текстовому полю 1 прибовляем звездочку(и теперь нас не одна хак прога не возмет(т.к. под звездочкой нет не каких символов))</font><br>


KeyAscii = 0 
<FONT color=Green > 'И не куда не посылаем сигнал нажатой клавиши(это чтоб в текстовом поле после звездочки не писались введенные в него(в текстовое поле(ты что забыл?)) символы)</font><br>


End If<br>
End Sub<br><br>








<h2>ШАГ 85:</h2>

<h3>Прога Restorator:</h3><p class="c2">
Хоть это и к VB не имеет ни кокого отношение(хотя кто знает...), но все равно я решил, не проподать же добру, о такой проге должен знать каждый. Эта прога нужна для изменения EXE и DLL файлов(а ты думал только на ассемблере можно такие вещи можно делать?). Короче скачивай ее с моего сайта, вместе с русификатором и кряком. Русифицируй и взламывай ее. Сейчас мы немного изменим калькулятор. Нажми Файл>>Открыть. В папке Windows ищи файл CALC.  Нашел? Молодец! Теперь открой его. В правой части Restorator`a появилось все содержимое калькулятора. В папке Menu - хранится меню калькулятора, в Dialog - диалоги, в String всякие слова, обращения, в папке Icon - хранятся все иконки.
В файлах есть еще и папка Bitmap, JPEG..., они хранят рисунки. Ну начнем, наши великие исправления! Для начала сменим Iconку. В 3-ем окне выбери диск C:<br>
<img src="rest.jpg" alt="Ресторатор"><br>
Теперь открой папку Icon, там будет файл SC. Нажми на него правой кнопкой мыши, и поставь Извлечь как>>Извлечь как SC.BMP. Теперь в диске C: утебя извлеклись несколько файлов BMP. Открой SC.BMP,  и в нем что - нибудь подрисуй. Теперь из 3-его окна перениси файл SC.BMP в файл SC(он в папке Icon в 1-ом окне). Все, первое сделали(И у тебя всегда над исправленным объектом будет стрелка, как у ярлыка(<img src="icon.jpg" alt="Ресторатор">)).
<br>
Теперь изменим меню.
<b>Включи Режим правки(Просмоторщик>>Режим Правки)</b>, выбери папку Menu, и файл 106. Там будет такая фенька:<br>

106 MENU<br>
{<br>
 POPUP "&СПравка"<br>
 {<br>
  MENUITEM "&CКопировать\tCtrl+C", 300<br>
Сдесь я немного изменил раздел Правка(СПравка), и подраздел Копировать(на Скопировать). Тоже так измени. Нажми F8 чтобы принять изменения. Ну остальное сам меняй. Теперь сохраним. Нажми Файд>>Сохранить как, и выбери CALC.EXE, он тебя спросит: "Заменить?" Жми Да. Теперь войди в Пуск>>Програмы>>Стандартные>>Калькулятор. Все что мы меняли, поменялось!
<h2>ШАГ 86:</h2>

<h3>Прога Restorator. Захват Иконок:</h3><p class="c2">
Т.к. у тебя скорее всего не хватает иконок и курсоров, то мы сейчас захватим все иконки и курсора, которые известны системе(у меня теперь 13327 иконок и курсоров). Для этого войди в Инструменты>>Захват Ресурсов. Поставь галки на "Иконки" и "Курсора". В двух текстовых полях впиши C:\<br>
<img src="cyrs.jpg" alt="Ресторатор"><br>
Жми на кнопку "Захват Теперь", и жди. Когда все иконки и курсора будут захвачены, заходи в диск C:, и там ты увидишь 2 папки Icon и Cyrsor. 







<h2>ШАГ 87</h2>
<h3>Базы Данных - Начало</h3><p class="c2">
Ну как я и говорил, что база данных это любой текст, который где - то хранится. У МелкоСофта есть спец прога, для создания баз данных. Ты скажешь: "Мне это не надо, и я не буду читать этот глупый шаг, т.к. на хрен мне нужно где - то хранить текст, с помощью каких - то прог, когда я могу сделать прогу, которая будет сохранять текст в текстовой документ". Нет ты не прав, т.к. в текстовой документ, больше 40 KB не поместится, но это не важно. В базах данных можно хранить картинки, упорядоченный текст..., а в текстовом документе таково ты не когда не сделаешь. Для их создания нужна прога Access, она входит в пакет МелкоСофт Офис (это где Word, Exel), а это есть почти на каждом системнике. Т.к. у меня Office 97,и Access соответственно старый (в  Office 2000 наверное другие панельки, но смысл один и тот же).
<h2>ШАГ 88</h2>
<h3>Создание первой БД (База Данных)</h3><p class="c2">
Войди в Access, перед тобой появится окно:<br>
<img src="bd.jpg" title = "Создание БД"><br>
Поставь переключатель на Новая БД, и нажми на ОК (или нажми на Файл/Создать БД, у тебя появится окно "Создание", в нем выбери значок Новая БД, и нажми ОК). У тебя откроется окно "Файл Новой БД", нажми создать.



<br><img src="bd1.jpg" title = "Создание БД"><br>



Теперь у тебя на винте создался файл (у меня в Моих Документах), где будет все храниться.
Потом появляется еще одно окошко.
<br><img src="bd2.jpg" title = "Создание БД"><br>
Для начала ты научишься создавать таблицы, и для этого в кладке Таблицы нажми Создать, в появившимся окне (Новая таблица), жми на Режим таблицы. Все Table создана! В поле 1 впиши padre03@mail.ru, в поле 2 впиши VBStreets.narod.ru. Теперь удаляй все лишние столбцы, и сохраняй.
<br><img src="bd3.jpg" title = "Создание БД"><br>
При сохранении появляется окно (Сохранение, в нем будет текстовое поле, там по умолчанию вписано Таблица, оставь ее, и не чего не меняй), нажимай на ОК. Появляется ошибка (Ключевые поля не заданы), жми Да. Все, свою первую БД мы создали, а толку от нее нет, т.к. от нее пользы ни какой нет. А чтоб была польза, создай новый проект(Standart EXE), на форму кинь 2 метки, 2 текстовых поля, и объект Data(<img src="data.jpg" title = "Создание БД">), этот объект нужен для связи с Базой. У объекта Data, свойство Caption = "БД". У первой метки Caption = "Я напишу на:", у второй = "Я нажму на банер на:"
.Написал? Молодец! Теперь выполняй (ЖМИ НА БАННЕР!!!) Вот что у тебя должно получиться:
<br><img src="bd4.jpg" title = "Создание БД"><br>
Получилось? Отлично! Теперь присоеденим к нашему проекту, БД. Для этого выдели объект Data, и в свойствах 2 раза кликни по DatabaseName, в окне открытия файлов выбери свою базу, и кликни открыть, в свойстве RecordSource выбери Таблица. Теперь подсоединим Базу к текстовым полям.
У Text1 в свойстве DataSource выбери Data1,и в DataField = Поле! (это то где мы вписывали мой E -Mail). У Text2 - DataSource =  Data1,DataField = Поле 2.И если ты изменишь текст в текстовых полях, то он автоматом сохранится в базу. Отлично! Ты сделал свою первую Базу. Yes!!!
<h2>ШАГ 89</h2>
<h3>Подключаем Базу программно</h3><p class="c2">
В предыдущем шаге мы подключали Базу автоматом (т.е. без кода), но у этого способа есть 1 недостаток, его нельзя переносить на другие компы. Вот случай был, я сделал прогу Халявный инет (шаг 43), только пароль введенный одним ламером, который живет надо мной, записывался не в файл, а в базу. А я в начале даже и не подумал о том, что базу надо подключать не автоматом, а в ручную (автоматом не понятно почему глючит, но т.к. я по базам не спец, я не знаю (если ты знаешь, то пиши)). Ну, у ламера мы пароль узнали, только с помощью OpenPass и дискеты. Что - то я отвлекся, сделай такой же проект (как предыдущий), но ни чего не настраивай, а впиши код:<br> 

Private Sub Form_Load()<FONT color=Green > 'При запуске формы:</FONT><br>
Data1.DatabaseName = "db1.mdb"<FONT color=Green > 'Ищем базу в той же дирке где и сама прога</FONT><br>
Data1.RecordSource = "Таблица1"<FONT color=Green > 'Имя таблицы, для доступа к ней</FONT><br>
Text1.DataField = "Поле1"<FONT color=Green > 'В Text1 из Поле1 будет загружаться текст</FONT><br>
Text2.DataField = "Поле2"<FONT color=Green > 'В Text2 из Поле2 будет загружаться текст</FONT><br>
End Sub<br>
Как ты наверное заметил (Или нет?), что мы у текстового поля не указали свойство DataSource, это единственное свойство которое нельзя указать программно. Ну раз нельзя, так нельзя - тогда поставь его в окне свойств = Data1. Исходник - <a href="Bd.zip" class="a19">Здесь</a>

<h2>ШАГ 90</h2>
<h3>Задание по БД</h3><p class="c2">
Твоя цель расширить базу (под моим E - Mial`om и сайтом впиши что - нибудь), на форму кинь еще текстовое поле(Text3.DataField = "Код"), оно будет считать строки. Ну короче сам разбирайся! 
Исходник - <a href="Bd1.zip" class="a19">Здесь</a>





<br><br>


Если что - то не получилось, то
мыль мне, <a href="mailto:padre03@mail.ru" class=a19>padre03@mail.ru</a>.  И если ты зайдешь на мой сайт, кликни плиз по банеру Porta(сиреневый), мне за это немного бабла отвалется(2 цента). И если ты захочешь поддержать Отечественного производителя(т.е. Меня), то кликай по банеру раз в месяц. А если ты очень богатый, то не просто кликни, а еще что - нибудь купи.





















<em><p class="cc">автор учебника: Падре</em>
<br>
Дата создания: 3 апреля 2003 года<br></em>
<br></p>
<center>
<table width=468 height=60 border=2 bordercolor="#4173a3"><td  bordercolor="#4173a3"><center>
<p class="c2">Место под Банеры
</td>
<tr><td>
<center>
<a href="INFA.htm" target="0">
<img src="baner.gif" alt="Официальный сайт учебника - 'Программируем на Visual Basic'" border=0>
</a></center>
</td></table>






</body>
</html>
