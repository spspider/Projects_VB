


<html><head>
<style type="text/css">
.part2{color:#4173a3;font-weight:900;}
.part2:hover{color:red;font-weight:880}
.cd{font-size:18px;color:black;}
.c2{font-size:18px;color:black;}
.c1{font-size:45pt;}
.cc{font-size:13pt;font-weight:bold}
.t{color:red;}
.a9{color:#4173a3;font-weight:bold;}
.a9:hover{color:red;font-weight:880}
h2{font-size:21pt;font-weight:bold}
h3{font-size:17pt;font-weight:bold}
.a19{color:#4173a3;font-size:18px}
.a19:hover{color:red;font-size:18px}
.qw1{color:#4173a3; text-decoration: none}
.qw1:hover{color:red;text-decoration: underline}
body{
BORDER-RIGHT: 0px;
SCROLLBAR-FACE-COLOR: #CFDEEB;
PADDING-BOTTOM: 0px;
SCROLLBAR-HIGHLIGHT-COLOR: #CFDEEB;
VERTICAL-ALIGN: middle;
BORDER-LEFT: 0px;
SCROLLBAR-SHADOW-COLOR: black;
SCROLLBAR-ARROW-COLOR: black;
PADDING-TOP: 0px;
BORDER-BOTTOM: 0px;
SCROLLBAR-BASE-COLOR: black;
scrollbar-3dlight-color: #4173a3;
scrollbar-dark-shadow-color: #4173a3;}
</style>

<title>Программируем на Visual Basic'e</title>
</head>
<body background="1.jpeg">
<em >
<a href="http://vbstreets.narod.ru" class="a9">Главная</a>
<a href="http://gb.lpt.ru/gb.php?bid=7132" class="a9">Гостевая</a>
<a href="http://gb.lpt.ru/gb.php?bid=7137" class="a9">Форум</a>
<a href="INFA.htm" class="a9">INFA</a>
</em>

<H1 ><font size=6>Программируем на Visual Basic'e:</font></H1>

<p style="font-weight:bold; font-size:21px" >

<a href="vbasic.htm" class="part2">Часть 1</a>/<a href="vbasic2.htm" class="part2">Часть 2</a>/<a href="vbasic3.htm" class="part2">Часть 3</a>/<a href="vbasic4.htm" class="part2">Часть 4</a>/<a href="vbasic5.htm" class="part2">Часть 5</a>/<a href="vbasic6.htm" class="part2">Часть 6</a>/<a href="vbasic7.htm" class="part2">Часть 7</a>/<a href="vbasic8.htm" class="part2">Часть 8</a>/<a href="vbasic9.htm" class="part2">
Часть 9</a>/<a href="vbasic10.htm" class="part2">Часть 10</a>/<a href="vbasic11.htm" class="part2">Часть 11</a>/<a href="vbasic12.htm" class="part2">Часть 12</a>


/<a href="vbasic13.htm" class="part2">Часть 13</a>/<a href="vbasic14.htm" class="part2">Часть 14</a>

/Часть 15</font>
</p>


<h2>ШАГ 141</h2>
<h3>Что такое VBA? или Введение.</h3><p class="c2">

И так что такое VBA? Полностью название языка
расшифровывается так: Visual Basic for Applications.
Он поставляется с пакетом программ Office. Он создан, для того чтобы делать программы пакета Office под определенного пользователя. Т.е. с его помощью можно
делать программы, например для Worda, которые будут легко
выполнять однообразную работу за пользователя. В этой статье мы научимся
работать с так называемыми «Пользовательскими формами» написав маленькую
программу «Конвертор скорости км/ч в м/c». 
<br><br>
Эта статья рассчитана на тех, кто
уже умеет программировать (хотя бы чуть-чуть) на Visual Basic. Поэтому я не стану
объяснять, что такое переменные, как их записывать, что такое элементы управления и прочее...</p>
<td width=30%>
<font size=3><b><li><em>автор шага:</em> Ашот Даниелян
</b></font>
 <font size=3><b><li><em>Сайт:</em> <a href="http://www.worldvb.narod.ru/" target=0 class="qw1">Visual Basic</a> 
</b></font>


 <font size=3><b><li><em><font color=black>Мыло:</em> <A href="mailto:ashdan87@mail.ru" class=qw1>ashdan87@mail.ru</a></b></font>
<h2>ШАГ 142</h2>
<h3>Различия и сходства между  VBA и Visual Basic.</h3><p class="c2">

Сразу оговорюсь, всех различий и
сходств я не знаю. Я назову только основные сходства и различия языков. Первое
и самое главное: программы написанные на VBA невозможно компилировать в отдельные EXE файлы для Windows, для их работы необходимы окна
тех программ из пакета Offica
для которых они написаны, например Word, Excel,
PowerPoint, Access. В принципе написания
программного кода эти языки очень
похожи за исключением некоторых случаев, которые не рассматриваются в данном
примере. Интерфейсы двух языков очень похожи, и поэтому кто умеет работать с Visual Basicom
не встретит много трудностей в использовании VBA.<br><br>
<td width=30%>
<font size=3><b><li><em>автор шага:</em> Ашот Даниелян
</b></font>
 <font size=3><b><li><em>Сайт:</em> <a href="http://www.worldvb.narod.ru/" target=0 class="qw1">Visual Basic</a> 
</b></font>


 <font size=3><b><li><em><font color=black>Мыло:</em> <A href="mailto:ashdan87@mail.ru" class=qw1>ashdan87@mail.ru</a></b></font>
<h2>ШАГ 143</h2>
<h3>Создание программы на VBA с использованием USER FORM</h3><p class="c2">
А сейчас, как я и обещал,  мы начнем писать 1 программу с использованием User Form. Эта программа будет рассчитана для  Word. Чтобы начать писать программу запустим  Word (вы должны знать сами как это делать). После того как текстовый редактор откроется, запустим VBA. Есть два варианта запуска: 1 короткий, нажать Alt + F11, 2 длинный (вы его должны знать тоже): «Сервис * Макрос * Редактор Visual Basic». В открывшемся окне нажимаем «Insert * User Form». Должно получиться примерно так: <br>
<br><img src="image004.jpg"><br><br>
 
Все с объяснениями, кажется, я закончил, приступим к созданию самой программы. Меняем свойство Caption формы на: Программа конвертор. На форме располагаем объект Frame с именем  Frame 1 и свойством Caption = км/ч в м/с. В этот объект вставляем 2 текстовых поля с именами TextBox1 TextBox2. У TextBox2 свойство Locked = True (чтобы в него нельзя было ввести текст) .Напротив 1 текстового поля ставим метку (Label) со свойством Caption = «км/ч», напротив второго, метку с Caption = «Результат в м/с». Под текстовыми полями ставим кнопку с именем CommandButton1 и Caption = «Вставить результат в документ». У вас должна получится примерно такая форма:
<br>
<br><img src="image006.jpg"><br><br>





Приступим к созданию текста программы. Совсем забыл сказать: Наша программа будет (как вы уже наверное догадались) переводить км/ч в м/с и вставлять результат в документ Word. <br>
<br>
Вычисление результата мы вынесем в отдельную процедуру Scet, которую будем вызывать из события TextBox1_ Change  (оно работает при вводе текста в текстовое поле). Результат вычислений будет вставляться в TextBox2. Также, перед решением (в процедуре Scet) мы будем проверять, правильное ли введено значение в TextBox1 (оно должно быть только числовым и не быть меньше нуля), для этого будем использовать функции IsNumeric и Val (их синтаксис и применение смотрите в справке). Если пользователь введет неправильное значение, будет блокироваться кнопка (свойство Enabled = False). В кнопке будем использовать событие Click. При нажатии на нее будем проверять есть ли открытый документ Word, если его нет, то откроем его : If Documents.Count = 0   Then Documents.Add. Дальше мы будем вставлять в документ результаты наших вычислений, да непросто цифры голые вставлять, а целую фразу: Selection.Text = TextBox1.Text & " км/ч  = " & TextBox2.Text & " м/с". Теперь надо сделать так, чтобы наша фраза не стирала предыдущий текст (т.е снять с нее выделение).  Для этого есть функция Collapse, ее синтаксис: Selection.Collapse Direction:=wdCollapseEnd  (подробнее про нее смотрите в справочной системе). Дальше я привожу полный текст программы, надеюсь вы с ней разобрались:<br>
 <pre>
Private Sub CommandButton1_Click()
If Documents.Count = 0 Then Documents.Add
Selection.Text = TextBox1.Text & " км/ч  = " & TextBox2.Text & " м/с"
Selection.Collapse Direction:=wdCollapseEnd
End Sub

Private Sub TextBox1_Change()
Scet
End Sub

Private Sub Scet()
Dim rez As Double
If IsNumeric(TextBox1.Text) = True And Not Val(TextBox1.Text) = 0 Then
rez = ((TextBox1.Text) * 1000) / 60 / 60
TextBox2.Text = rez
CommandButton1.Enabled = True
Else
TextBox2.Text = ""
CommandButton1.Enabled = False
End If

End Sub
 </pre><p class="c2">
Теперь сделаем так, чтобы можно было запускать программу из Word’a. Для удобства переименуем нашу форму в Perevod (свойство Name формы). Потом создадим модуль  (Insert*Module) присвоим ему имя Convert (свойство Name модуля) и напишем туда следующий текст:
 <pre>ConvertCount()
Perevod.Show
End Sub </pre>
<p class="c2">
Теперь осталось вытащить нашу программу на одну из панелей Office’a. Для этого нажимаем на Другие кнопки (серый треугольник в конце панели инструментов), в длинном списке кнопок нажимаем на «Настройки». Перед вами откроется окно «Настройка», выберите в нем пункт «Команды». В разделе  «Категории» находим и кликаем на «Макросы». С право от «Макросов» находится раздел «Команды», в нем выбираем Normal.Convert.ConvertCount и перетаскиваем на одну из приглядевшихся вам панелей инструментов. Эту кнопку можно отредактировать, вместо названия поставить картинка, как у других кнопок. 

 <br><br>

На этом знакомство с User Form закончено. Если вам понравилась моя статья или возникли какие-нибудь вопросы ко мне шлите их мне на мыло. Также, я буду рад вашим исходникам написанным на VB6. 
<br><br>

<td width=30%>
<font size=3><b><li><em>автор шага:</em> Ашот Даниелян
</b></font>
 <font size=3><b><li><em>Сайт:</em> <a href="http://www.worldvb.narod.ru/" target=0 class="qw1">Visual Basic</a> 
</b></font>


 <font size=3><b><li><em><font color=black>Мыло:</em> <A href="mailto:ashdan87@mail.ru" class=qw1>ashdan87@mail.ru</a></b></font>




<h2>ШАГ 144</h2>
<h3>Контрол Winsock.   Узнаем свой IP адрес
</h3><p class="c2">
Этот контрол нужен в основном для связи с удаленным компом, но можно с ним делать и другие штуки. Например, щас мы узнаем свой IP адрес. Создай новый проект, нажми на Project/Components/MicrosoftWinsock Control 6.0, и кинь на форму появившийся на панели инструментов Winsock1, и кнопку. Код:<br>
Private Sub Command1_Click()<br>
MsgBox Winsock1.LocalIP<br>
End Sub<br><br>
<h2>ШАГ 145</h2>
<h3>Контрол Winsock. Ода о WinSock</h3><p class="c2">
WinSock - очень мощное средство Visual Basic для коммуникаций. Он позволяет работать со всеми роспостраненными протоколами связи: SMTP и  POP3 (E-Mail), FTP, HTTP (WWW), NNTP (News). Но наиболее интересной темой является, на мой взгляд, создание приложений клиент - сервер. Именно клиент - серверные приложения позволяют при связи между двумя компютерами, обменеватся данными, первый из которых будет подавать запросы, а второй - исполнять их. Если ты понял всю тему, то, наверное, уже догадался что именно этим способом ты сможешь испортить жизнь своему учителю информатики!          <br>  Ну а если не догадался - обясню. Нам необходимо создать две проги, одна - клиент, вторая - сервер. Клиент запущен на твоем компе, а сервер на компе учителя информатики и работает в скрытом режиме (то есть невидим!). У тебя, на клиенте есть кнопка "Убить гада!" и когда ее нажать, то клиент посылает серверу команду "Убить гада!". А в сервере есть код, который перезагружает  комп и, кроме него, есть росписание: "Если клиент подал команду "Убить гада!" - перезагрузить комп. Втыкаешь?<br>
<br>
Хорошо, а теперь будем писать проги. Прога должна взять на себя контроль над CD-ROM учителя информатики.
<br>
Сначала создадим сервер.<br>

Создай стандартный проект, и добавь компонент "MicrosoftWinSock control". В роздел "General"  скопируй етот код:
<br>
Private Declare Function mciSendString Lib "winmm.dll" Alias "mciSendStringA" (ByVal lpstrCommand As String, ByVal lpstrReturnString As Any, ByVal uReturnLength As Long, ByVal hwndCallback As Long) As Long ' декларируем апи функцию для конторля над CD-ROM<br>
Dim Status As Integer 'обявляем переменную - статус CD-ROM<br><br>

В событии Form_Load ты должен указать серверу, какой порт он будет слушать и заставить его слушать!                                         Для этого пишем вот такой код:

Private Sub Form_Load()    <br>
<br>
Winsock1.LocalPort = 1000 ' указываем какой порт должен слушать сервер<br>
                                                                          <br>                                                                                                    
Winsock1.Listen ' заставляем его слушать<br>
<br>
End Sub<br>
<br>
Теперь нам надо написать процедуру обработки запроса на соединение. Для етого напишите такой код:
<br>
Private Sub winsock1_ConnectionRequest(ByVal requestID As Long)<br>
<br>
If Winsock1.State <> sckClosed Then Winsock1.Close ' если сервер не закрыт, то закрываем его <br>

Winsock1.Accept requestID ' принимаем запрос<br>

End Sub<br><br>

Еще осталось написать процедуру приема данных:<br><br>

Private Sub winsock1_dataArrival(ByVal BytesTotal As Long)<br>

Dim Data As String 'обявляем переменную для хранения данных<br>

Winsock1.GetData Data 'присваиваем переменной Data все принятые данные<br>

If Data = "open" Then Status = mciSendString("Set CDAudio Door Open Wait", 0&, 0, 0)<br>

<br>' ну а здесь - инструкция, которая говорит: если Data равно "open", тогда открываем CD-ROM

If Data = "close" Then Status = mciSendString("Set CDAudio Door Closed Wait", 0&, 0, 0)<br>

'а здесь  инструкция, которая говорит, если Data равно "close", тогда закрываем CD-ROM<br>
<br>
End Sub<br>
<br>
Все!Сервер готов!
<br>
Теперь ты должен создать клиент.
<br>

Открой Visual Basic еще раз (первый не закрывай).
<br>
Создай стандартный проект, и добавь компонент "MicrosoftWinSock control". Добавь кнопку и назови её "open", а в свойстве caption напиши "Открыть". Добавь еще одну кнопку и назови её "close", а в свойстве caption напиши "Закрыть". 
<br>
В событии Form_Load напиши код:
<br>
Public Sub Form_Load ()<br>

Winsock1.RemoteHost = "127.0.0.1" ' указываем адресс сервера (здесь ты указал свой же адресс)<br>

Winsock1.RemotePort = 1000 ' указываем порт сервера (в нашем случае 1000)<br>

Winsock1.Connect  ' вызываем коннект<br>

End Sub<br>
<br>
В коде кнопки "open" пишешь:<br>
<br>
Private Sub open_Click()<br>

Winsock1.SendData "open" ' посылаем серверу комманду "open"<br>

End Sub<br>
<br>
В коде кнопки "close" пишешь:<br>
<br>
Private Sub open_Click()
<br>
Winsock1.SendData "close" ' посилаем серверу комманду "close"
<br>
End Sub<br><br>
Готово!  <br>

Теперь запусти сервер и после этого запусти клиент. Нажми на кнопку "Открыть", потом на "Закрыть". Круто?                       <br>   Можно также использовать это в сети, запустив на одном компе сервер, а на другом клиент, но при этом надо изменить     ІР "127.0.0.1" на ІР  компа, где будет запущен сервер.
<br>









<br><p>
<font size=3><b><li><font color=black><em>Автор шага:</em> Ракочий Назар</b></font>


<font size=3><b><li><font color=black><em>Страна(город):</em> Укранина(Тернополь)</b></font>


 <font size=3><b><li><em><font color=black>Сайт:</em> <a href="http://newrate.boom.ru/" target=0 class="qw1">newrate.boom.ru</a> 
</b></font>
 <font size=3><b><li><em><font color=black>Мыло:</em> <A href="mailto:dasharm@mail.ru" class=qw1>dasharm@mail.ru</a></b></font>
<font size=3><b><li><font color=black><em>Дата написания:</em> 5.07.2003 </b></font>
<br>







 
<h2>ШАГ 146</h2>
<h3>Ссылки</h3><p class="c2">
Т.к. мой учебник еще пишется, а в тебе бурлит инстинкт познания (Во как сказал!), то я решил здесь написать самые лучшие на мой взгляд ссылки (ВНИМАНИЕ!!! это не коммерческие ссылки, я писал их не с целью чтоб мне отвалили немного бабла (хотя все равно влятри кто отвалит), или еще что - нибудь сделали, а с целью сэкономить твое драгоценное время, которое ты потратишь в поисках хорошего VB сайта. Все сайты представлены в порядке убывания, от крутого к стремному.<br><br>

1. <A 
href="http://vbstreets.narod.ru" class="a19">VBStreets.narod.ru</A> - Сайт супер! Статей, иходников, приколов до хрена, есть форум, чат, проги, библиотеки, справочники, VB журналы, игры... С сайта качай последние версии этого учебника.

<BR>

2. <A 
href="http://sharig.webzone.ru/IndexMainTopic.htm" class="a19">VBCode.FAQ</A> - этот сайт содержит столько инфы о VB, сколько VBStreets.ru может только мечтать, короче сайт супер, и ему пока нет равных(если на него зайдешь, то зайди в раздел "Примеры").
<br>
3. <A href="http://www.firststeps.ru" class="a19">VB Шаг за Шагом</A> - на этом сайте тоже много инфы<br>


4. <A 
href="http://vbkoders.net.ru/" class="a19">VBKODERs</A> - на этом сайте ты можешь найти много всего, но это неважно, самое главное то, что на нем есть VB Журнал.<br>

5. <A 
href="http://VBNet.ru" class="a19">VBNet.ru</A> - на сайте есть очень много статей, исходников, примеров...<br>


<br>
Ну на этом больше я не чего не нашел, если у тебя есть ссылка на сайт, который ты считаешь достойным быть в моем учебнике, оставляй у меня на форуме его ссылку.





<font color="green" size=6>
<hr size=5 color=green width=80%>
<p class="c2"></font>
Ну вроде все. Последние версии этого учебника скачивай с моего сайта <a href="http://vbstreets.narod.ru" class=a19>vbstreets.narod.ru</A>, а на этом я пока закончу. В этот учебник не вошли темы: Создание библиотек; Классы модули - с чем их едят?; VBScript; DerectX ... Эти темы, и другие будут написаны в ближайшее время, так что качай последние версии с моего сайта. Если ты сам написал статью, исходник - отсылай мне на мыло: <a href="mailto:padre03@mail.ru" class=a19>padre03@mail.ru</a> - я ее обязательно размещу на своем творенье.
Если у тебя есть какие - нибудь вопросы, пиши мне, и я на них отвечу, или оставь их на форуме. Покиданьки булы!











<em><p class="cc">автор учебника: Падре</em>
<br>
Дата создания: 22 мая 2003 года<br></em>
<br></p>


<center>
<table width=468 height=60 border=2 bordercolor="#4173a3"><td  bordercolor="#4173a3"><center>
<p class="c2">Место под Банеры
</td>
<tr><td>
<center>
<a href="INFA.htm" target="0">
<img src="baner.gif" alt="Официальный сайт учебника - 'Программируем на Visual Basic'" border=0>
</a></center>
</td></table>







</body>
</html>
